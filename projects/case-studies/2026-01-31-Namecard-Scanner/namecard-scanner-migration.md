# 名片掃描系統重構：從 GAS 到 Python VM (Namecard Scanner Migration)

## 🏗️ 系統演進：從 PoC 到 Production
原先系統是由同事使用 Google Apps Script (GAS) 搭建的 PoC (Proof of Concept)，雖然驗證了流程可行，但在性能與擴展性上遇到瓶頸。本週完成了向 Python VM 架構的全面遷移。

### 1. 架構升級 (Infrastructure Shift)
- **核心心臟**：從 GAS 遷移至 **Python 運行於 Linux VM**。
- **網路通訊**：使用 **Cloudflare** 指向 VM 的外部 IP，確保連線穩定與安全。
- **優點**：解決了 GAS 的執行時間限制與併發瓶頸，運算速度有感提升。

### 2. 資料流與正則校驗 (Data Pipeline & Regex)
- **流程**：Line 拍照 -> OCR 掃描 -> **Regex 預處理** -> Odoo 資料比對。
- **關鍵決策**：在與 Odoo 的「乾淨資料」比對前，先透過 Regex 進行初步清洗。
- **邏輯**：避免因為 OCR 的雜訊（如全形半形、多餘空白）導致錯誤的「不對齊提示」。

---

## 🛡️ 穩定性設計：異步與超時 (Asynchrony & Timeouts)

### 1. 非同步處理 (Asynchronous Execution)
- **問題**：單一使用者的重型請求（如大量 OCR）不應導致其他使用者排隊。
- **解決**：設計異步處理機制，使多個使用者請求能並行處理，提升系統吞吐量。

### 2. 超時保護 (Timeout Strategy)
- **問題**：避免使用者因為 Line 端或後端偶發的網路問題而陷入無限等待。
- **解決**：實作超時機制，當請求超過預定時間（如 Line 服務掛掉）即自動跳轉/回報。

---

## 🎨 UX 與前端優化
- **Line FlexCard 重構**：重新設計訊息提示卡片，將 OCR 提取的摘要以更結構化、更美觀的方式呈現給使用者。
- **核心思維**：雖然專案的核心是後端邏輯，但 UX 的提升是降低使用者「慢」的體感的關鍵。

---

## 💭 工程反思
- **從 PoC 到 MVP 的跨度**：理解到一個「能跑」的專案與一個「好用、穩定」的系統之間，隔著的是對併發、網路架構與錯誤處理的深度理解。
- **AI 輔助學習**：透過 AI 快速掌握異步程式設計與網路配置，實現了超越原有技術儲備的高速交付。
