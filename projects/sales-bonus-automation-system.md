# 業務獎金自動化與資料整合系統 (P-06)

## 📌 專案簡介
這是一個本質上的「資料工程」任務。目標是從公司混亂的案件總表與各部門各自維護的手工報表中，撈取並整合出正確的業務獎金計算基礎。

## 🚀 專案核心目標
- **資料清洗與標準化**：整合不同部門排列方式不一（有人橫向擴充，有人向下延伸）的歷史資料。
- **自動同步機制**：利用 GAS 定時抓取並更新來源表數據，確保計算表永遠處於最新狀態。
- **建立「嚴格搜尋」邏輯**：在混亂的數據中設計精準的 Match 機制，避免獎金計算錯誤。

## ⚙️ 技術架構與邏輯
- **核心引擎**: Google Apps Script (GAS) & **防禦性 Excel 架構**。
- **數據對應**: 改用 `XLOOKUP` 與 `INDEX MATCH` 取代脆弱的 `VLOOKUP`，增強對欄位變動的容錯率。
- **多列繼承邏輯**: 針對「一筆交易佔兩列（第二列為介紹人）」的非結構化版面，設計「隱藏輔助鍵 (Hidden Keys)」機制，使邏輯上回歸「一列一筆」，同時維持視覺上的兩列格式。
- **自動化**: 使用 Time-driven Triggers 定時同步來源表。

## 🧩 遇到的挑戰與解決方法
- **解決「視覺格式 vs 數據邏輯」的衝突**：主管要求保留舊有的兩列式視覺排版，但這會導致公式錯位。透過「輔助鍵繼承」方案，成功在不改動外觀的情況下實現全自動計算。
- **手動維護的隨意性**：面對人工隨意插入行、拼寫不一的現況，建立「案號索引」作為唯一錨點，並加入 `IFERROR` 友善提示機制，引導使用者修正髒資料。

## 🔒 安全性與專業倫理 (Confidentiality)
- **單人維護體系**：基於獎金數據的極高敏感性，本案採「單人主導、資料隔離」模式。
- **邏輯與數據分離**：設計時確保計算邏輯（公式/GAS）與具體金額數據解耦，方便在不接觸敏感數據的情況下進行邏輯 Review，降低單點故障風險。

---
> **備註**：此任務證明了開發者在「資料處理」與「流程自動化」上的深度實力，能將複雜的人工作業轉化為可靠的工程化流程，並展現了處理企業敏感數據的專業素養。
