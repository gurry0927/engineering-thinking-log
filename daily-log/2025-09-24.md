# [2025-09-24] 自動化進階：從模板替換到多格式郵件發送

## 今日目標
- [x] 實作 GAS 觸發感知：當 Sheet 更新時自動替換 Doc 模板佔位符。
- [x] 解決雲端檔案 (Docs/Sheets) 無法直接作為附件寄送的問題。

## 學習與筆記
- **檔案轉換機制**：
    - **Google Docs** 需透過 `.getAs("application/pdf")` 轉為 PDF 才能作為郵件附件。
    - **Google Sheets** 需轉為 `application/vnd.openxmlformats-officedocument.spreadsheetml.sheet` (XLSX) 才能附件發送。
- **雲端檔案本質**：Docs/Sheets 是雲端格式（JSON 架構），而非傳統二進制檔案，因此「附件」本質上是執行了一次「導出」動作。
- **權限魔鬼**：若不使用附件而改用「連結」，必須確保收件者擁有該檔案的 Google Drive 存取權限。

## 遇到的挑戰與解決方案
- **問題**：想直接將存檔的 Doc 寄給他人，卻發現收到的只是文字或無法打開。
- **解決**：釐清「附件 = 轉換過的實體檔」與「連結 = 雲端原檔」的區別。根據需求選擇轉為 PDF（正式）或提供連結（協作）。

## 心態感悟
- 慢慢掌握了 Google 生態系的「組裝感」。從偵測資料、代換內容到格式轉換，每一步都是可編排的積木。

---

## 外部建議與提議 (AI Suggestions)
- [ ] 最佳化版本範例程式碼（防止無限觸發）。
- [ ] 自動判斷檔案類型並選擇導出格式的通用的郵件函式。
