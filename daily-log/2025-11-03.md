# 每日開發日誌：2025-11-03

## 📝 今日任務
- **業務獎金規則整理**：主管要求將所有的獎金計算規則與函數整合進 Excel 跑。
- **資料清理與對應**：處理「一筆資料佔兩列」且「介紹人資訊分裂」的非結構化數據。
- **心態調適**：面對「保密」要求下的單人作業，思考職場敏感數據的處理原則。

## 💡 關鍵決策與邏輯
1. **防禦性 Excel 設計**：
   - 意識到 `VLOOKUP` 在不穩定結構中的脆弱性，考慮改用 `XLOOKUP` 或 `INDEX MATCH`。
   - 引入「隱藏輔助鍵（Hidden Keys）」機制，解決「視覺上兩列、邏輯上一列」的需求。
   - 避免直接在原始表改動，思考「後台運算表」的解耦方案。
2. **解決「介紹人分裂」問題**：
   - 邏輯思路：判斷若業務欄為空且介紹人欄有值，則視為上一列的附加資訊。
   - 嘗試方案：利用 `IF` 函數與絕對引用建立繼承邏輯，確保公式不會錯向。

## 🚩 遇到挑戰
- **手動維護的隨意性**：同一個案件有時佔一列，有時佔兩列，難以建立穩定索引。
- **工具限制**：公司要求完全在 Excel 上跑路，限制了使用 Python 或資料庫的空間，考驗純 Excel 的架構能力。

## 💭 今日反思
- **資料孤島現象**：敏感的獎金數據往往被要求保密且由單人維護。這雖然提高了安全性，但也增加了「單點故障 (Single Point of Failure)」的風險，必須建立良好的文件 SOP 以降低依賴性。

---
> **備註**：為遵守保密協議，不記錄具體金額與人名，僅紀錄邏輯架構。
