# 文檔與表單拼接策略：從「暴力貼上」到「結構化生成」

## 核心概念
將表格資料（Sheets/Excel）與段落文字（Docs/Word）自動化合併時，格式跑版是最大的技術痛點。核心解法應從「內容填充」而非「文件合併」的角度切入。

## 詳細筆記

### 1. 策略 A：模板填寫法 (Template-based)
*   **做法**：在 Word 中建立固定版面，使用預留標籤（如 `{{customer_name}}`）。
*   **優點**：版面結構 100% 固定，不因內容長短而大規模跑版。
*   **適用情境**：簽呈、合約、固定格式報告。

### 2. 策略 B：表格物件嵌入 (Table Injection)
*   **做法**：不複製原本的格線格式，而是將 Sheets 資料清洗後，以「純資料狀態」注入到 Word 定義好的 Table 物件中。
*   **優點**：避免帶入 Excel 的欄寬、邊線等雜訊。

### 3. 策略 C：報表化思維 (Reporting Tools)
*   **做法**：不再試圖合併兩個 Office 文檔。改用報表引擎 (ReportLab) 或 BI 工具 (Looker Studio)。
*   **優點**：原生即為「圖表 + 文字」設計。

### 4. 產出端防禦 (PDF Defense)
*   如果文件不再需要編輯，一律產出 PDF 為最終成果。這是對付跑版的「物理隔絕」。

## 學習心得
「拼在一起」的難點不在於程式，而在於兩個不相容排版系統的博弈。與其試圖讓大象（Word）去理解貓（Sheet）的步伐，不如讓人類直接給牠們一個固定的舞池（模板）。

---

## 外部建議與提議 (AI Suggestions)
- [ ] 三層次文件拼接實作範例（Google Docs API 版本）。
