# Google Sheets 實戰技巧：合併儲存格、表單觸發與異地紀錄

## 核心概念
Google Sheets 除了作為介面，其背後的觸發器與 API 邏輯是自動化系統的資料驅動力。

## 詳細筆記

### 1. 合併儲存格的取值邏輯
*   **現象**：Excel 中的 D1 在 Google Sheets 合併後標註為 `D1:E2`。
*   **規則**：合併儲存格的值**僅存在於「左上角」的格子**（即 D1）。
*   **操作**：在 GAS 或公式中，直接指向左上角座標即可取值；取出範圍時，其他格子會傳回空值。

### 2. 表單提交自動化 (`onFormSubmit`)
*   **機制**：利用 GAS 的「表單提交時」觸發器，可在資料進入 Root Sheet 的瞬間執行額外邏輯。
*   **異地紀錄 (Alternative Logging)**：可在觸發時將特定欄位（如：員工編號、時間、檔案連結）同步寫入另一個「管理用分頁」，實現資料分流與權限隔離。

### 3. 上傳檔案的處理
*   **使用者傳檔案給 Bot**：Bot 接收 `fileId` 後需呼叫 `getContent` API 抓取。
*   **Bot 回傳檔案**：無法直接推播 Byte 數據。最佳解法是將檔案存入 Drive，並將「共享連結」回傳。

## 學習心得
Google Sheets 的威力在於其「可被觸發性」。只要掌握了 `e.values` 的解析，就能將單純的填表轉化為觸發複雜系統流程的起點。

---

## 外部建議與提議 (AI Suggestions)
- [ ] 常見 Google Form 觸發器範例代碼。
- [ ] 自動將上傳檔案轉換為超連結並存入追蹤表的完整 GAS 範例。
