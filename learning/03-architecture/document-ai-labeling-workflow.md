# Document AI 實務：自訂樣本標記與自動化標註的工作流

## 📌 背景
在處理上千頁的工程報告書 (P-07) 時，通用型 OCR 無法準確辨識特定格式的檢測數值與異常標記。我們需要利用 Document AI 的自訂處理器 (Custom Processor) 來提升精確度。

## 🛠️ 技術實作路徑

### 1. 智慧 PDF 切割 (Preprocessing)
由於 Document AI 單次處理頁數有限且成本考量，我們使用 Python 先行掃描 PDF：
- **關鍵字偵測**：識別章節標頭（如「檢測結果」、「異常說明」）。
- **邏輯切割**：將上千頁 PDF 裁切成 10-20 頁的一組高價值片段。

### 2. 自訂樣本標記 (Custom Labeling)
在 Google Cloud Console 中親自執行標記：
- **欄位定義**：建立 `report_no`, `test_value`, `status_code` 等特定 schema。
- **樣本多樣性**：包含模糊影印、歪斜掃描與不同版次的範例，以提升模型魯棒性。

### 3. 資料提取與自動寫入 (Post-processing)
- **JSON 解析**：將 API 回傳的結構化資料轉入本地數據結構。
- **Google Sheets API**：透過特定腳本，將資料寫入對應的行列位置，實現「無人化標註」。

## 💡 架構價值：從「AI 工具」到「AI 工作流」
這項專案的核心不在於使用的模型有多強，而在於**管線 (Pipeline)** 的設計：
- **分頁技術**解決了長文件處理的基礎難題。
- **標記思維**補足了通用模型的領域知識。
- **端到端整合**則直接消滅了最後一層的手工轉錄成本。

---
> **結語**：工程師的價值在於定義過程，而非僅僅執行 API。
