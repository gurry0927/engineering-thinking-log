# AI 文件解析：從檔名讀取進階至語義標題

## 核心概念
「讀取附件名稱」與「讀取文件內容大標」在技術上是完全不同的層級。後者涉及了 OCR (光學字元辨識) 與 NLP/LLM (自然語言處理) 的深度整合。

## 詳細筆記

### 1. 技術分層
*   **Level 1：檔名讀取**：GAS 內建 `getName()` 即可達成，難度極低，純規則判斷。
*   **Level 2：結構化文件讀取 (Word/Excel)**：
    *   Word (.docx) 具有 Header 層級，可用 `python-docx` 等庫直接提取。
    *   Excel：僅有儲存格概念，需自定義讀取規則。
*   **Level 3：非結構化文件 (PDF/掃描檔)**：
    *   需先 OCR 轉為純文字，再利用 AI 判斷「字體最大者 = 標題」。

### 2. AI 的介入點 (LLM Pipeline)
1.  **Extract**：將檔案內容轉為純文字 String。
2.  **Analyze**：將文字餵給 GPT/Gemini，並下 Prompt：「這份文件的主要大標與分類是什麼？」
3.  **Return**：回傳 JSON 格式結果，供 GAS 決定資料夾路徑。

### 3. 現實成本
使用 LLM API 解析每個附件，在大量文件場景下會有顯著的費用產生。建議先用「檔名規則」過濾，僅對無法判斷的檔案調用 AI。

## 學習心得
不要被「AI」這個詞迷惑。在設計系統時，應區分「規則能解決的事」與「語義能解決的事」，並先實作前者。

---

## 外部建議與提議 (AI Suggestions)
- [ ] 最小 AI 範例流程：PDF OCR -> GPT 分類 -> Drive 存檔腳本。
